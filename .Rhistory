n <- 200
library(Matrix)
library(irlba)
if (!require(ggplot2)) {
install.packages("ggplot2")
library(ggplot2)
}
library(Rcpp)
simulate_Erdos_renyi <- function(n,p) {
A <- Matrix(0,n,n)
A[upper.tri(A,diag = TRUE)] <- rbinom(choose(n,2) + n,1,p)
A <- forceSymmetric(A,"U")
return(A)
}
title <- "omega_both_1"
Rcpp::sourceCpp("generate_corr_sbm.cpp")
print("Sourced C++ Code, beginning simulations...")
set.seed(1234)
p <- .2
a <- .3
b <- .1
corr = .4
A1 <- simulate_Erdos_renyi(n,p)
A2 <- Matrix(simulate_corr_SBM(a,b,as.matrix(A1),corr,p))
omega <- rowSums(A1 == 1 & A2 == 1)
